BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%linen%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 258392385.974893
 ALGERIA                   |   1997 | 448231496.141198
 ALGERIA                   |   1996 | 456828371.633425
 ALGERIA                   |   1995 |  455952720.03729
 ALGERIA                   |   1994 | 446791259.530417
 ALGERIA                   |   1993 | 453264442.999521
 ALGERIA                   |   1992 | 449398998.149645
 ARGENTINA                 |   1998 | 275698785.797795
 ARGENTINA                 |   1997 | 471870767.385682
 ARGENTINA                 |   1996 | 469543795.030507
 ARGENTINA                 |   1995 | 474271428.760895
 ARGENTINA                 |   1994 | 464530245.284703
 ARGENTINA                 |   1993 | 474406473.190138
 ARGENTINA                 |   1992 | 478337230.933102
 BRAZIL                    |   1998 | 277831022.829504
 BRAZIL                    |   1997 | 469780961.993271
 BRAZIL                    |   1996 |  461188386.03118
 BRAZIL                    |   1995 | 463385034.388479
 BRAZIL                    |   1994 | 464083554.290363
 BRAZIL                    |   1993 | 461602198.305909
 BRAZIL                    |   1992 | 467645191.492402
 CANADA                    |   1998 | 271853661.715324
 CANADA                    |   1997 | 476412509.901774
 CANADA                    |   1996 | 474518783.996056
 CANADA                    |   1995 | 471926198.079629
 CANADA                    |   1994 | 473171672.981241
 CANADA                    |   1993 |  475004751.31168
 CANADA                    |   1992 | 471326082.985003
 CHINA                     |   1998 | 272172699.831162
 CHINA                     |   1997 | 464940977.766572
 CHINA                     |   1996 | 464565777.464071
 CHINA                     |   1995 | 460918081.712272
 CHINA                     |   1994 | 463229436.188824
 CHINA                     |   1993 | 464829791.557395
 CHINA                     |   1992 | 470271752.014367
 EGYPT                     |   1998 | 270780196.767272
 EGYPT                     |   1997 | 458504554.244826
 EGYPT                     |   1996 | 470937643.928204
 EGYPT                     |   1995 | 462476829.193897
 EGYPT                     |   1994 | 461902731.449394
 EGYPT                     |   1993 | 458870018.995735
 EGYPT                     |   1992 | 468806809.957463
 ETHIOPIA                  |   1998 | 264302023.061307
 ETHIOPIA                  |   1997 |  451424723.53016
 ETHIOPIA                  |   1996 |  441497059.01547
 ETHIOPIA                  |   1995 | 451682792.706794
 ETHIOPIA                  |   1994 | 456632844.555521
 ETHIOPIA                  |   1993 | 447243820.469877
 ETHIOPIA                  |   1992 | 456576842.481155
 FRANCE                    |   1998 | 262754096.869788
 FRANCE                    |   1997 | 452582952.544348
 FRANCE                    |   1996 | 447232888.547692
 FRANCE                    |   1995 |   445300840.7433
 FRANCE                    |   1994 | 452767315.445368
 FRANCE                    |   1993 | 452894658.332219
 FRANCE                    |   1992 | 459329342.524994
 GERMANY                   |   1998 | 279017205.780313
 GERMANY                   |   1997 | 469838385.856368
 GERMANY                   |   1996 | 475249934.633637
 GERMANY                   |   1995 | 471189444.389755
 GERMANY                   |   1994 | 478923469.430534
 GERMANY                   |   1993 |  477577167.52395
 GERMANY                   |   1992 | 470630471.836237
 INDIA                     |   1998 | 280156292.121203
 INDIA                     |   1997 | 474741925.444228
 INDIA                     |   1996 | 476089916.917063
 INDIA                     |   1995 | 472390292.487525
 INDIA                     |   1994 | 479466775.126131
 INDIA                     |   1993 |  476633277.00111
 INDIA                     |   1992 | 482295317.713464
 INDONESIA                 |   1998 | 273478137.776509
 INDONESIA                 |   1997 |  463014875.75365
 INDONESIA                 |   1996 | 464176912.862345
 INDONESIA                 |   1995 | 460391696.841609
 INDONESIA                 |   1994 |  461726135.14719
 INDONESIA                 |   1993 | 458310573.813507
 INDONESIA                 |   1992 |   457077039.1946
 IRAN                      |   1998 | 272972286.281839
 IRAN                      |   1997 | 458157690.304829
 IRAN                      |   1996 | 469413830.355229
 IRAN                      |   1995 | 473277300.146837
 IRAN                      |   1994 |  468308628.40171
 IRAN                      |   1993 | 467969155.287641
 IRAN                      |   1992 | 468308692.247874
 IRAQ                      |   1998 | 277578354.867551
 IRAQ                      |   1997 | 474103228.031149
 IRAQ                      |   1996 | 476634776.174848
 IRAQ                      |   1995 | 478029762.276654
 IRAQ                      |   1994 | 474369987.611456
 IRAQ                      |   1993 | 477899297.533713
 IRAQ                      |   1992 |  468494425.56033
 JAPAN                     |   1998 | 269340681.709333
 JAPAN                     |   1997 | 463980649.921082
 JAPAN                     |   1996 | 460084637.153756
 JAPAN                     |   1995 | 456366730.921433
 JAPAN                     |   1994 | 463579343.358433
 JAPAN                     |   1993 | 457478431.291702
 JAPAN                     |   1992 | 454302097.450648
 JORDAN                    |   1998 | 274072203.274409
 JORDAN                    |   1997 | 460299079.053448
 JORDAN                    |   1996 |  460582540.38981
 JORDAN                    |   1995 | 463163054.943872
 JORDAN                    |   1994 | 461214577.523562
 JORDAN                    |   1993 | 461477143.127435
 JORDAN                    |   1992 | 464433825.259859
 KENYA                     |   1998 | 267372008.430283
 KENYA                     |   1997 | 463763211.977482
 KENYA                     |   1996 | 472468391.903942
 KENYA                     |   1995 | 466885080.920024
 KENYA                     |   1994 | 470489179.935498
 KENYA                     |   1993 | 464471528.107704
 KENYA                     |   1992 | 461345297.053715
 MOROCCO                   |   1998 | 270654147.152037
 MOROCCO                   |   1997 |  459024470.35941
 MOROCCO                   |   1996 | 471312376.877205
 MOROCCO                   |   1995 | 454722485.399146
 MOROCCO                   |   1994 | 456020224.480332
 MOROCCO                   |   1993 | 459310901.403344
 MOROCCO                   |   1992 | 472044916.194041
 MOZAMBIQUE                |   1998 | 272845265.563529
 MOZAMBIQUE                |   1997 | 465190204.225689
 MOZAMBIQUE                |   1996 | 463871726.074121
 MOZAMBIQUE                |   1995 | 465337328.964335
 MOZAMBIQUE                |   1994 | 460551303.156875
 MOZAMBIQUE                |   1993 | 467000632.959156
 MOZAMBIQUE                |   1992 |  458178705.08759
 PERU                      |   1998 |  268772740.43104
 PERU                      |   1997 | 468759111.410621
 PERU                      |   1996 |  464405925.12014
 PERU                      |   1995 | 472589583.132766
 PERU                      |   1994 | 468660256.735215
 PERU                      |   1993 | 464352060.394101
 PERU                      |   1992 | 476693643.566484
 ROMANIA                   |   1998 | 275991365.723705
 ROMANIA                   |   1997 | 461371223.623227
 ROMANIA                   |   1996 | 476704795.329151
 ROMANIA                   |   1995 | 469231997.236698
 ROMANIA                   |   1994 | 473804587.802149
 ROMANIA                   |   1993 | 465455775.927491
 ROMANIA                   |   1992 | 466660087.061263
 RUSSIA                    |   1998 | 270577939.652428
 RUSSIA                    |   1997 | 466660982.723879
 RUSSIA                    |   1996 | 463994909.774288
 RUSSIA                    |   1995 | 464873068.355861
 RUSSIA                    |   1994 | 457004547.249495
 RUSSIA                    |   1993 | 460710452.426938
 RUSSIA                    |   1992 | 469057507.762816
 SAUDI ARABIA              |   1998 | 273394097.160046
 SAUDI ARABIA              |   1997 | 463732305.437249
 SAUDI ARABIA              |   1996 | 472048298.292041
 SAUDI ARABIA              |   1995 | 471009491.116202
 SAUDI ARABIA              |   1994 |  460630641.71322
 SAUDI ARABIA              |   1993 | 469024632.010434
 SAUDI ARABIA              |   1992 | 464833970.840765
 UNITED KINGDOM            |   1998 | 273690606.086459
 UNITED KINGDOM            |   1997 | 472816363.070734
 UNITED KINGDOM            |   1996 |  466425179.63792
 UNITED KINGDOM            |   1995 |   466196667.6845
 UNITED KINGDOM            |   1994 | 463281896.260324
 UNITED KINGDOM            |   1993 | 455205637.874673
 UNITED KINGDOM            |   1992 | 462387455.034826
 UNITED STATES             |   1998 | 279319587.053031
 UNITED STATES             |   1997 | 467943787.709153
 UNITED STATES             |   1996 | 472132569.315685
 UNITED STATES             |   1995 | 474888889.312646
 UNITED STATES             |   1994 | 480953363.722525
 UNITED STATES             |   1993 | 470437230.083534
 UNITED STATES             |   1992 |  473281564.02571
 VIETNAM                   |   1998 | 274474802.834865
 VIETNAM                   |   1997 | 463801815.216122
 VIETNAM                   |   1996 | 473313649.779423
 VIETNAM                   |   1995 | 463233280.183144
 VIETNAM                   |   1994 | 469749934.800182
 VIETNAM                   |   1993 | 469677850.485762
 VIETNAM                   |   1992 | 469486809.585537
(175 rows)

COMMIT;
COMMIT
