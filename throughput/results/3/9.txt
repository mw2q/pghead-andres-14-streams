BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%mint%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 264295630.525312
 ALGERIA                   |   1997 |   456698367.1243
 ALGERIA                   |   1996 | 461892704.890205
 ALGERIA                   |   1995 | 465513085.851273
 ALGERIA                   |   1994 | 453915699.179414
 ALGERIA                   |   1993 | 460862364.917943
 ALGERIA                   |   1992 | 457814569.644955
 ARGENTINA                 |   1998 | 271974362.963498
 ARGENTINA                 |   1997 | 467344748.520617
 ARGENTINA                 |   1996 | 472500329.391258
 ARGENTINA                 |   1995 | 471240836.247532
 ARGENTINA                 |   1994 | 466586395.902798
 ARGENTINA                 |   1993 | 462455128.500776
 ARGENTINA                 |   1992 | 465940794.156845
 BRAZIL                    |   1998 | 275720406.462477
 BRAZIL                    |   1997 | 474103922.323332
 BRAZIL                    |   1996 | 471659399.863081
 BRAZIL                    |   1995 | 471174571.559925
 BRAZIL                    |   1994 | 468971194.007244
 BRAZIL                    |   1993 | 473627726.525759
 BRAZIL                    |   1992 | 466853225.789533
 CANADA                    |   1998 | 273570702.908227
 CANADA                    |   1997 | 477603347.550761
 CANADA                    |   1996 | 480091376.752773
 CANADA                    |   1995 | 473841928.743351
 CANADA                    |   1994 | 476876393.131784
 CANADA                    |   1993 | 476003811.601482
 CANADA                    |   1992 | 476081490.242601
 CHINA                     |   1998 | 269937099.437631
 CHINA                     |   1997 | 466469439.176848
 CHINA                     |   1996 | 459892191.419161
 CHINA                     |   1995 | 461705715.416234
 CHINA                     |   1994 | 462770134.676726
 CHINA                     |   1993 | 461805805.438228
 CHINA                     |   1992 | 465251004.655462
 EGYPT                     |   1998 |  271296584.37357
 EGYPT                     |   1997 | 459195563.018946
 EGYPT                     |   1996 | 461965771.390731
 EGYPT                     |   1995 | 455583318.454594
 EGYPT                     |   1994 | 456595315.535228
 EGYPT                     |   1993 |  470815910.73864
 EGYPT                     |   1992 | 460285145.332446
 ETHIOPIA                  |   1998 | 268711418.625221
 ETHIOPIA                  |   1997 | 445236949.033883
 ETHIOPIA                  |   1996 | 457914766.865462
 ETHIOPIA                  |   1995 | 462355964.051901
 ETHIOPIA                  |   1994 | 463507403.091892
 ETHIOPIA                  |   1993 | 450157532.156612
 ETHIOPIA                  |   1992 | 458604487.280456
 FRANCE                    |   1998 | 265624765.254412
 FRANCE                    |   1997 | 462934416.850335
 FRANCE                    |   1996 |  462366008.46107
 FRANCE                    |   1995 | 461414985.537429
 FRANCE                    |   1994 |  469621003.21507
 FRANCE                    |   1993 |  462256431.74048
 FRANCE                    |   1992 | 466689143.875735
 GERMANY                   |   1998 |   277557518.2706
 GERMANY                   |   1997 | 481931658.585783
 GERMANY                   |   1996 | 481878493.576215
 GERMANY                   |   1995 | 473806440.698956
 GERMANY                   |   1994 |  471777162.95502
 GERMANY                   |   1993 | 473011034.348742
 GERMANY                   |   1992 | 475982397.934809
 INDIA                     |   1998 | 279572836.884782
 INDIA                     |   1997 |  472919287.95266
 INDIA                     |   1996 | 475465345.151845
 INDIA                     |   1995 | 475057780.147553
 INDIA                     |   1994 | 474933702.518569
 INDIA                     |   1993 | 472132489.564142
 INDIA                     |   1992 | 483744593.387945
 INDONESIA                 |   1998 | 270944984.255398
 INDONESIA                 |   1997 | 458619646.233227
 INDONESIA                 |   1996 | 468947213.206962
 INDONESIA                 |   1995 | 452777523.035943
 INDONESIA                 |   1994 |  458859075.08073
 INDONESIA                 |   1993 |  458379846.69811
 INDONESIA                 |   1992 | 458975588.353801
 IRAN                      |   1998 | 266548537.903318
 IRAN                      |   1997 | 456304831.526953
 IRAN                      |   1996 | 462225270.625117
 IRAN                      |   1995 | 453062657.379886
 IRAN                      |   1994 | 457072236.234268
 IRAN                      |   1993 | 460274499.920166
 IRAN                      |   1992 | 461284516.038903
 IRAQ                      |   1998 | 272463664.579628
 IRAQ                      |   1997 | 465406893.676558
 IRAQ                      |   1996 | 469584751.049732
 IRAQ                      |   1995 | 465173919.201249
 IRAQ                      |   1994 | 475417092.947689
 IRAQ                      |   1993 | 466250374.305118
 IRAQ                      |   1992 | 466750789.364638
 JAPAN                     |   1998 | 270873820.826662
 JAPAN                     |   1997 | 460131950.436522
 JAPAN                     |   1996 | 460164753.847274
 JAPAN                     |   1995 | 467262181.097503
 JAPAN                     |   1994 | 460201165.849466
 JAPAN                     |   1993 | 463622299.223999
 JAPAN                     |   1992 | 464932298.126568
 JORDAN                    |   1998 | 273616758.994779
 JORDAN                    |   1997 | 456238743.331867
 JORDAN                    |   1996 | 460174296.569671
 JORDAN                    |   1995 |  460476532.86367
 JORDAN                    |   1994 | 459866943.309192
 JORDAN                    |   1993 | 458042881.102039
 JORDAN                    |   1992 | 450840304.554828
 KENYA                     |   1998 | 280087408.078927
 KENYA                     |   1997 | 474258405.210539
 KENYA                     |   1996 | 481963539.353954
 KENYA                     |   1995 | 469222196.274818
 KENYA                     |   1994 | 484539196.674953
 KENYA                     |   1993 | 469713992.218997
 KENYA                     |   1992 |  473333695.67604
 MOROCCO                   |   1998 | 270338517.920834
 MOROCCO                   |   1997 | 446579937.317883
 MOROCCO                   |   1996 |  457598763.60209
 MOROCCO                   |   1995 | 468772289.200717
 MOROCCO                   |   1994 | 458797116.136806
 MOROCCO                   |   1993 | 455931554.992362
 MOROCCO                   |   1992 | 462734840.895922
 MOZAMBIQUE                |   1998 | 274347526.997247
 MOZAMBIQUE                |   1997 | 459060664.604544
 MOZAMBIQUE                |   1996 | 468410529.166035
 MOZAMBIQUE                |   1995 | 463377181.093016
 MOZAMBIQUE                |   1994 | 465617289.177918
 MOZAMBIQUE                |   1993 | 471106983.371196
 MOZAMBIQUE                |   1992 | 462960335.589414
 PERU                      |   1998 | 273323164.977905
 PERU                      |   1997 | 473247113.767254
 PERU                      |   1996 | 469301170.344396
 PERU                      |   1995 | 467465143.931057
 PERU                      |   1994 | 471555714.140681
 PERU                      |   1993 | 464016073.426771
 PERU                      |   1992 | 466477271.427256
 ROMANIA                   |   1998 | 277107442.671613
 ROMANIA                   |   1997 | 465525008.069165
 ROMANIA                   |   1996 | 472087879.387958
 ROMANIA                   |   1995 | 469678530.579897
 ROMANIA                   |   1994 | 468252770.920025
 ROMANIA                   |   1993 |  475376606.64801
 ROMANIA                   |   1992 |  470125396.77132
 RUSSIA                    |   1998 | 273570056.230206
 RUSSIA                    |   1997 | 460983975.263591
 RUSSIA                    |   1996 | 471623304.451318
 RUSSIA                    |   1995 | 460866238.807968
 RUSSIA                    |   1994 | 461170739.762711
 RUSSIA                    |   1993 | 469194320.013363
 RUSSIA                    |   1992 | 460114697.906162
 SAUDI ARABIA              |   1998 | 270350009.985039
 SAUDI ARABIA              |   1997 | 475469690.999097
 SAUDI ARABIA              |   1996 | 465587782.055745
 SAUDI ARABIA              |   1995 | 470728368.216763
 SAUDI ARABIA              |   1994 | 466956036.676501
 SAUDI ARABIA              |   1993 | 473842394.556523
 SAUDI ARABIA              |   1992 | 474429824.492578
 UNITED KINGDOM            |   1998 | 265840260.288913
 UNITED KINGDOM            |   1997 | 460710851.962684
 UNITED KINGDOM            |   1996 | 449043250.532336
 UNITED KINGDOM            |   1995 | 458155571.777846
 UNITED KINGDOM            |   1994 | 453586824.939765
 UNITED KINGDOM            |   1993 | 455439397.185426
 UNITED KINGDOM            |   1992 | 456906408.804345
 UNITED STATES             |   1998 | 283797982.870176
 UNITED STATES             |   1997 | 481427036.121913
 UNITED STATES             |   1996 | 475140940.049905
 UNITED STATES             |   1995 | 472674717.479261
 UNITED STATES             |   1994 |  482542344.71789
 UNITED STATES             |   1993 | 476577614.815755
 UNITED STATES             |   1992 |  472087685.87649
 VIETNAM                   |   1998 | 278305459.028469
 VIETNAM                   |   1997 | 464594562.581829
 VIETNAM                   |   1996 | 465797126.215169
 VIETNAM                   |   1995 | 466827800.158335
 VIETNAM                   |   1994 | 470443071.708734
 VIETNAM                   |   1993 | 466469133.048695
 VIETNAM                   |   1992 |  468954600.43565
(175 rows)

COMMIT;
COMMIT
