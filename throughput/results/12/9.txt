BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%white%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 273620706.089991
 ALGERIA                   |   1997 |  458815715.83254
 ALGERIA                   |   1996 | 461152240.798947
 ALGERIA                   |   1995 | 463422342.501027
 ALGERIA                   |   1994 | 456153293.759927
 ALGERIA                   |   1993 | 465508434.471489
 ALGERIA                   |   1992 | 472600020.283404
 ARGENTINA                 |   1998 | 265944220.604873
 ARGENTINA                 |   1997 |  464265522.93415
 ARGENTINA                 |   1996 | 465130845.065853
 ARGENTINA                 |   1995 | 464687130.184687
 ARGENTINA                 |   1994 | 461423772.445231
 ARGENTINA                 |   1993 | 459692644.709533
 ARGENTINA                 |   1992 | 460218809.381876
 BRAZIL                    |   1998 | 274999986.436455
 BRAZIL                    |   1997 | 470575790.092547
 BRAZIL                    |   1996 | 462107044.937648
 BRAZIL                    |   1995 | 470239801.801999
 BRAZIL                    |   1994 | 467750027.988544
 BRAZIL                    |   1993 | 465711943.274394
 BRAZIL                    |   1992 | 467165431.353304
 CANADA                    |   1998 |  273939450.81948
 CANADA                    |   1997 | 477963144.969375
 CANADA                    |   1996 | 482570777.982468
 CANADA                    |   1995 | 474984678.179787
 CANADA                    |   1994 | 484601599.208746
 CANADA                    |   1993 | 483699731.327152
 CANADA                    |   1992 | 485397906.981298
 CHINA                     |   1998 | 272481769.135633
 CHINA                     |   1997 |  466534546.96454
 CHINA                     |   1996 | 464321196.873075
 CHINA                     |   1995 | 470404056.035109
 CHINA                     |   1994 | 473085133.152659
 CHINA                     |   1993 | 466575163.813984
 CHINA                     |   1992 | 476855786.024254
 EGYPT                     |   1998 | 266836139.622515
 EGYPT                     |   1997 | 460902773.810627
 EGYPT                     |   1996 |  460602318.19439
 EGYPT                     |   1995 | 457958381.844203
 EGYPT                     |   1994 | 454824981.492305
 EGYPT                     |   1993 | 467328102.140841
 EGYPT                     |   1992 | 461618596.095894
 ETHIOPIA                  |   1998 | 267195208.393852
 ETHIOPIA                  |   1997 |  460909223.60517
 ETHIOPIA                  |   1996 | 464081638.479049
 ETHIOPIA                  |   1995 | 470131669.256692
 ETHIOPIA                  |   1994 | 468070595.160976
 ETHIOPIA                  |   1993 | 466113771.617397
 ETHIOPIA                  |   1992 | 464282621.580482
 FRANCE                    |   1998 | 271222713.173497
 FRANCE                    |   1997 | 469433357.586604
 FRANCE                    |   1996 | 467485145.629958
 FRANCE                    |   1995 | 474269539.681117
 FRANCE                    |   1994 | 466168207.185404
 FRANCE                    |   1993 |  464010666.35059
 FRANCE                    |   1992 | 465378185.291422
 GERMANY                   |   1998 | 279431456.055877
 GERMANY                   |   1997 | 482930565.287156
 GERMANY                   |   1996 | 477573337.884035
 GERMANY                   |   1995 | 481360811.616967
 GERMANY                   |   1994 | 474021077.770474
 GERMANY                   |   1993 | 474820350.948491
 GERMANY                   |   1992 | 474078126.950567
 INDIA                     |   1998 |  281200439.95934
 INDIA                     |   1997 |  477871685.06134
 INDIA                     |   1996 | 481508462.820335
 INDIA                     |   1995 | 475556638.237608
 INDIA                     |   1994 | 484626260.609852
 INDIA                     |   1993 | 473456428.373066
 INDIA                     |   1992 |  486349901.48936
 INDONESIA                 |   1998 | 272871318.578509
 INDONESIA                 |   1997 | 475242406.425694
 INDONESIA                 |   1996 | 468655450.207684
 INDONESIA                 |   1995 | 462408656.587844
 INDONESIA                 |   1994 | 470039652.850697
 INDONESIA                 |   1993 | 464344985.140187
 INDONESIA                 |   1992 | 463954119.563874
 IRAN                      |   1998 | 273321753.741769
 IRAN                      |   1997 | 468936252.721558
 IRAN                      |   1996 | 463402877.464369
 IRAN                      |   1995 | 472138805.195876
 IRAN                      |   1994 | 470772428.197102
 IRAN                      |   1993 | 465491006.473264
 IRAN                      |   1992 | 467033325.586225
 IRAQ                      |   1998 | 278634724.157544
 IRAQ                      |   1997 | 480735939.370404
 IRAQ                      |   1996 | 476882367.934537
 IRAQ                      |   1995 | 475517537.956034
 IRAQ                      |   1994 | 482676249.668053
 IRAQ                      |   1993 | 480032093.750479
 IRAQ                      |   1992 | 477215307.144743
 JAPAN                     |   1998 | 275429579.373132
 JAPAN                     |   1997 | 465784029.932505
 JAPAN                     |   1996 | 473412193.036439
 JAPAN                     |   1995 | 472331744.196524
 JAPAN                     |   1994 | 465720538.877238
 JAPAN                     |   1993 | 471251629.987389
 JAPAN                     |   1992 | 464470455.785784
 JORDAN                    |   1998 | 268671666.422959
 JORDAN                    |   1997 |  465790896.38316
 JORDAN                    |   1996 | 458058094.290885
 JORDAN                    |   1995 | 462697245.782301
 JORDAN                    |   1994 | 462183179.428882
 JORDAN                    |   1993 | 456833405.053953
 JORDAN                    |   1992 | 464674109.502917
 KENYA                     |   1998 | 272021375.698362
 KENYA                     |   1997 | 467656473.941761
 KENYA                     |   1996 | 467668047.459615
 KENYA                     |   1995 | 461757397.746376
 KENYA                     |   1994 |  466947011.87491
 KENYA                     |   1993 | 465847891.970164
 KENYA                     |   1992 | 467022263.459307
 MOROCCO                   |   1998 | 272258754.234297
 MOROCCO                   |   1997 | 468579614.053582
 MOROCCO                   |   1996 | 473474994.411728
 MOROCCO                   |   1995 | 466508422.304528
 MOROCCO                   |   1994 | 465088445.691206
 MOROCCO                   |   1993 | 465320888.657609
 MOROCCO                   |   1992 | 464355488.688416
 MOZAMBIQUE                |   1998 | 270099599.530593
 MOZAMBIQUE                |   1997 | 460657767.236102
 MOZAMBIQUE                |   1996 | 462451171.354715
 MOZAMBIQUE                |   1995 | 463855663.506957
 MOZAMBIQUE                |   1994 | 458148016.368608
 MOZAMBIQUE                |   1993 | 460868592.115933
 MOZAMBIQUE                |   1992 |  461780360.97552
 PERU                      |   1998 |  272695448.30833
 PERU                      |   1997 | 465284834.476526
 PERU                      |   1996 | 458977517.291993
 PERU                      |   1995 | 460937154.214954
 PERU                      |   1994 | 461249236.130494
 PERU                      |   1993 | 462824462.008489
 PERU                      |   1992 | 471628330.107136
 ROMANIA                   |   1998 | 283095272.671297
 ROMANIA                   |   1997 |  480938765.09052
 ROMANIA                   |   1996 | 475576524.841584
 ROMANIA                   |   1995 | 481045685.051264
 ROMANIA                   |   1994 | 483440970.721244
 ROMANIA                   |   1993 | 481664437.225885
 ROMANIA                   |   1992 | 472623160.299446
 RUSSIA                    |   1998 | 274047324.767871
 RUSSIA                    |   1997 | 468759239.842693
 RUSSIA                    |   1996 | 471956231.134157
 RUSSIA                    |   1995 | 477357789.254181
 RUSSIA                    |   1994 | 468124431.912792
 RUSSIA                    |   1993 |  472190769.04808
 RUSSIA                    |   1992 |  472402512.64025
 SAUDI ARABIA              |   1998 | 275286719.360037
 SAUDI ARABIA              |   1997 | 473739465.820736
 SAUDI ARABIA              |   1996 | 462866595.697523
 SAUDI ARABIA              |   1995 | 471528419.976287
 SAUDI ARABIA              |   1994 | 469309541.738792
 SAUDI ARABIA              |   1993 | 468650524.061282
 SAUDI ARABIA              |   1992 | 483653794.336391
 UNITED KINGDOM            |   1998 | 274338621.698945
 UNITED KINGDOM            |   1997 | 471461849.971975
 UNITED KINGDOM            |   1996 | 469106922.288824
 UNITED KINGDOM            |   1995 | 459308362.019387
 UNITED KINGDOM            |   1994 | 463761094.950927
 UNITED KINGDOM            |   1993 | 466007277.318305
 UNITED KINGDOM            |   1992 | 470027109.413045
 UNITED STATES             |   1998 | 277117404.437214
 UNITED STATES             |   1997 | 474626393.746622
 UNITED STATES             |   1996 | 474802788.903294
 UNITED STATES             |   1995 | 470776297.988878
 UNITED STATES             |   1994 | 473935227.735258
 UNITED STATES             |   1993 | 463154563.291187
 UNITED STATES             |   1992 |  459635976.38706
 VIETNAM                   |   1998 | 270670719.868032
 VIETNAM                   |   1997 | 465558061.965849
 VIETNAM                   |   1996 | 473682161.875826
 VIETNAM                   |   1995 | 479866605.119347
 VIETNAM                   |   1994 | 470555647.485848
 VIETNAM                   |   1993 | 473504626.069596
 VIETNAM                   |   1992 |  472560642.24755
(175 rows)

COMMIT;
COMMIT
